add_dmb() %>%
add_prospects()
lwnn_basic_output <- load_salaries() %>%
add_fangraph_ids() %>%
add_dmb()
lwnn_basic_output <- load_salaries() %>%
add_fangraph_ids()
mlb_hitters_ids <- read.csv("F:/Documents/LWNN/fangraphs/hitters_mlb.csv",stringsAsFactors = FALSE) %>%
rename(name=Name) %>%
mutate(fangraph_id=as.character(playerid)) %>%
distinct(fangraph_id,name)
mlb_pitchers_ids <- read.csv("F:/Documents/LWNN/fangraphs/pitchers_mlb.csv",stringsAsFactors = FALSE) %>%
rename(name=Name) %>%
mutate(fangraph_id=as.character(playerid)) %>%
distinct(fangraph_id,name)
minors_hitters_ids <- read.csv("F:/Documents/LWNN/fangraphs/hitters_minors.csv",stringsAsFactors = FALSE) %>%
rename(name=Name,fangraph_id=playerid) %>%
distinct(name,fangraph_id)
minors_pitchers_ids <- read.csv("F:/Documents/LWNN/fangraphs/pitchers_minors.csv",stringsAsFactors = FALSE) %>%
rename(name=Name,fangraph_id=playerid) %>%
distinct(name,fangraph_id)
library(lwnnr)
lwnn_basic_dmb_output("F:/Documents/LWNN/dmb.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
update_current_year_stats()
lwnn_basic_dmb_output("F:/Documents/LWNN/dmb.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
# Worst current hitter
worst_current_hitter <- load_salaries() %>%
add_fangraph_ids() %>%
add_current_season_reduced() %>%
filter(lwnn == 1 & !is.na(wOBA_2019) & PA_2019>30) %>%
select(team,name,wOBA_2019,PA_2019,Team_2019) %>%
arrange(wOBA_2019) %>%
group_by(team) %>%
mutate(worst_hitter=row_number()) %>%
filter(worst_hitter==1)
write.csv(worst_current_hitter,file="F:/Documents/LWNN/worst_hitter.csv",row.names=FALSE)
lwnn_basic_output <- load_salaries() %>%
add_fangraph_ids() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced() %>%
mutate(team=case_when(is.na(team)~"Free Agent",
TRUE~team),
wOBA_2019=round(wOBA_2019,digits = 3),
FIP_2019=round(FIP_2019,digits=2))
View(lwnn_basic_output)
unsigned_minors <- load_salaries() %>%
add_fangraph_ids() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced() %>%
mutate(team=case_when(is.na(team)~"Free Agent",
TRUE~team),
wOBA_2019=round(wOBA_2019,digits = 3),
FIP_2019=round(FIP_2019,digits=2)) %>%
filter(lwnn==0 & level=="minors")
unsigned_minors <- load_salaries() %>%
add_fangraph_ids() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced() %>%
mutate(team=case_when(is.na(team)~"Free Agent",
TRUE~team),
wOBA_2019=round(wOBA_2019,digits = 3),
FIP_2019=round(FIP_2019,digits=2)) %>%
filter(is.na(lwnn) & level=="minors")
unsigned <- load_salaries() %>%
add_fangraph_ids() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced() %>%
mutate(team=case_when(is.na(team)~"Free Agent",
TRUE~team),
wOBA_2019=round(wOBA_2019,digits = 3),
FIP_2019=round(FIP_2019,digits=2)) %>%
filter(is.na(lwnn) & level=="minors")
unsigned <- load_salaries() %>%
add_fangraph_ids() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced() %>%
mutate(team=case_when(is.na(team)~"Free Agent",
TRUE~team),
wOBA_2019=round(wOBA_2019,digits = 3),
FIP_2019=round(FIP_2019,digits=2)) %>%
filter(is.na(lwnn))
lwnn_no_data <- unsigned %>%
filter(is.na(type)) %>%
select(name,team,salary_2019) %>%
distinct()
library("devtools")
document()
library(lwnnr)
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
document()
document()
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(lwnnr)
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(lwnnr)
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
hitters_minors <- read.csv("F:/Documents/LWNN/fangraphs/hitters_minors.csv",stringsAsFactors = FALSE) %>%
rename(Team_2019 = Team,
fangraph_id=playerid,
wOBA_2019=wOBA,
PA_2019=PA,
name=Name) %>%
select(fangraph_id,Team_2019,PA_2019,wOBA_2019) %>%
mutate(type="hitter",level="minors")
hitters_mlb <- read.csv("F:/Documents/LWNN/fangraphs/hitters_mlb.csv",stringsAsFactors = FALSE) %>%
rename(wOBA_2019 = wOBA,
PA_2019 = PA,
Team_2019 = Team,
name=Name) %>%
mutate(fangraph_id=as.character(playerid)) %>%
select(fangraph_id,name,Team_2019,PA_2019,wOBA_2019) %>%
mutate(type="hitter",level="mlb")
pitchers_minors <- read.csv("F:/Documents/LWNN/fangraphs/pitchers_minors.csv",stringsAsFactors = FALSE) %>%
rename(FIP_2019 = FIP,
IP_2019 = IP,
Team_2019 = Team,
fangraph_id=playerid,
name=Name) %>%
select(fangraph_id,name,Team_2019,IP_2019,FIP_2019) %>%
mutate(type="pitcher",level="minors")
pitchers_mlb <- read.csv("F:/Documents/LWNN/fangraphs/pitchers_mlb.csv",stringsAsFactors = FALSE) %>%
rename(FIP_2019 = FIP,
IP_2019 = IP,
Team_2019 = Team,
name=Name) %>%
mutate(fangraph_id=as.character(playerid)) %>%
select(fangraph_id,name,Team_2019,IP_2019,FIP_2019) %>%
mutate(type="pitcher",level="mlb")
library(lwnnr)
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
update_current_year_stats()
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
mlb_draft_2019 <- read.csv("F:/Documents/LWNN/fangraphs/mlb_draft_2018.csv",stringsAsFactors = FALSE)
View(mlb_draft_2019)
mlb_draft_2019 <- read.csv("F:/Documents/LWNN/fangraphs/mlb_draft_2018.csv",stringsAsFactors = FALSE) %>%
filter(PLAYER!="")
mlb_draft_2019 <- read.csv("F:/Documents/LWNN/fangraphs/mlb_draft_2018.csv",stringsAsFactors = FALSE) %>%
filter(PLAYER!="",
SIGNING.BONUS!="",
SIGNING.BONUS!="--")
mlb_draft_2019 <- read.csv("F:/Documents/LWNN/fangraphs/mlb_draft_2018.csv",stringsAsFactors = FALSE) %>%
filter(PLAYER!="",
SIGNING.BONUS!="",
SIGNING.BONUS!="--") %>%
separate(PLAYER,c("last_name","first_name"),sep=", ") %>%
mutate(name=str_c(first_name,last_name,sep=" "))
View(mlb_draft_2019)
mlb_draft_2019 <- read.csv("F:/Documents/LWNN/fangraphs/mlb_draft_2018.csv",stringsAsFactors = FALSE) %>%
filter(PLAYER!="",
SIGNING.BONUS!="",
SIGNING.BONUS!="--") %>%
separate(PLAYER,c("last_name","first_name"),sep=", ") %>%
mutate(name=str_c(first_name,last_name,sep=" "),
draft_pick=paste0(RD,".",PICK)) %>%
add_fangraph_ids()
View(mlb_draft_2019)
library("devtools")
document()
library(lwnnr)
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(lwnnr)
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(lwnnr)
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(lwnnr)
update_current_year_stats()
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
update_current_year_stats()
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
dmb_pitchers <- read.csv("F:/Documents/LWNN/dmb/pitchers_fmt.csv",stringsAsFactors = FALSE) %>%
filter(!is.na(fangraph_id)) %>%
mutate(POS=case_when(!is.na(ST)~"SP",
TRUE~"RP")) %>%
rename(OPS_LHB=OPS,
OPS_RHB=OPS.1,
STA_SP=ST,
STA_RP=REL) %>%
select(name,Age,T,POS,IP,ERA,G.GF,OPS_LHB,OPS_RHB,STA_SP,STA_RP,fangraph_id) %>%
mutate(type="pitcher")
View(dmb_pitchers)
dmb_hitters <- read.csv("F:/Documents/LWNN/dmb/hitters_fmt.csv",stringsAsFactors = FALSE) %>%
filter(!is.na(fangraph_id)) %>%
mutate(OPS_LHP=OBP.1+SLG.1,
OPS_RHP=OBP.2+SLG.2,
POS=paste0(ifelse(!is.na(C.RN),"CA/",""),
ifelse(!is.na(X1B.RN),"1B/",""),
ifelse(!is.na(X2B.RN),"2B/",""),
ifelse(!is.na(X3B.RN),"3B/",""),
ifelse(!is.na(SS.RN),"SS/",""),
ifelse(!is.na(LF.RN),"LF/",""),
ifelse(!is.na(CF.RN),"CF/",""),
ifelse(!is.na(RF.RN),"RF/","")
)) %>%
mutate(POS=str_replace(POS,"/$","")) %>%
select(name,Age,POS,AB,OBP,SLG,STL,OPS_LHP,OPS_RHP,X1B.RN,X1B.ER,X2B.RN,X2B.ER,X3B.RN,X3B.ER,SS.RN,SS.ER,LF.RN,LF.ER,CF.RN,CF.ER,RF.RN,RF.ER,OF.ARM,C.RN,C.ER,C.ARM,PB,fangraph_id) %>%
mutate(type="hitter")
View(dmb_hitters)
library(lwnnr)
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
update_current_year_stats()
#update_current_year_stats()
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
update_current_year_stats()
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
library("devtools")
document()
library(lwnnr)
players_all <- load_salaries() %>%
add_fangraph_ids() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced %>%
filter(lwnn == 1 | dmb == 1)
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
players_all <- load_salaries() %>%
add_fangraph_ids() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced() %>%
add_draft_2018() %>%
filter(lwnn == 1 | dmb == 1) %>%
mutate(team=case_when(is.na(team) ~ "Free Agent",
TRUE~team))
View(players_all)
pitchers <- players_all %>%
filter(type=="pitcher") %>%
select(name,team,salary_2019,Age,POS,T,IP,ERA,FIP,
K.9,BB.9,OPS_LHB,OPS_RHB,G.GF,STA_SP,STA_RP,
Team_2019,FIP_2019,IP_2019,FV,draft_2018)
test <- players_all %>% filter(is.na(type))
View(test)
write.xlsx2
add_fangraph_ids()
add_fangraphs_ids
?write.xlsx2
library(lwnnr)
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
update_current_year_stats()
output_lwnn_basic_dmb("F:/Documents/LWNN/dmb.xlsx")
library("devtools")
document()
library(lwnnr)
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(xlsx)
library(baseballr)
library(xml2)
library(rvest)
#update_current_year_stats()
output_lwnn_basic("F:/Documents/LWNN/dmb.xlsx")
players_all <- load_salaries() %>%
add_fangraph_ids() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced() %>%
add_draft_2018() %>%
filter(lwnn == 1 | dmb == 1) %>%
mutate(team=case_when(is.na(team) ~ "Free Agent",
TRUE~team))
file_name <- "F:/Documents/LWNN/dmb.xlsx"
pitchers <- players_all %>%
filter(type=="pitcher") %>%
select(name,team,salary_2019,Age,POS,T,IP,ERA,FIP,
K.9,BB.9,OPS_LHB,OPS_RHB,G.GF,STA_SP,STA_RP,
Team_2019,FIP_2019,IP_2019,FV,draft_2018)
hitters <- players_all %>%
filter(type=="hitter") %>%
select(name,team,salary_2019,Age,POS,
AB,wOBA,OBP,SLG,STL,OPS_LHP,OPS_RHP,
Team_2019,wOBA_2019,PA_2019,FV,draft_2018,
X1B.RN,X1B.ER,X2B.RN,X2B.ER,X3B.RN,X3B.ER,
SS.RN,SS.ER,LF.RN,LF.ER,CF.RN,CF.ER,RF.RN,
RF.ER,OF.ARM,C.RN,C.ER,C.ARM,PB)
no_data <- players_all %>%
filter(is.na(type)) %>%
select(name,team,salary_2019)
write.xlsx2(as.data.frame(pitchers),file=file_name,sheetName = "Pitchers",row.names=FALSE,showNA=FALSE)
library(lwnnr)
output_lwnn_basic("F:/Documents/LWNN/dmb.xlsx")
install.packages("openxlsx")
library(openxlsx)
?addWorksheet
excel_wb <- createWorkbook()
addWorksheet(excel_wb,"Pitchers")
addWorksheet(excel_wb,"Hitters")
addWorksheet(excel_wb,"No Data")
writeDataTable(wb, 1, pitchers, startRow = 1, startCol = 1, tableStyle = "TableStyleDark1")
writeDataTable(wb, 2, hitters, startRow = 1, startCol = 1, tableStyle = "TableStyleDark2")
writeDataTable(wb, 3, no_data, startRow = 1, startCol = 1, tableStyle = "TableStyleDark7")
saveWorkbook(wb, file_name, overwrite = TRUE)
excel_wb <- createWorkbook()
addWorksheet(excel_wb,"Pitchers")
addWorksheet(excel_wb,"Hitters")
addWorksheet(excel_wb,"No Data")
writeDataTable(excel_wb, 1, pitchers, startRow = 1, startCol = 1, tableStyle = "TableStyleDark1")
writeDataTable(excel_wb, 2, hitters, startRow = 1, startCol = 1, tableStyle = "TableStyleDark2")
writeDataTable(excel_wb, 3, no_data, startRow = 1, startCol = 1, tableStyle = "TableStyleDark7")
saveWorkbook(excel_wb, file_name, overwrite = TRUE)
?writeDataTable
excel_wb <- createWorkbook()
addWorksheet(excel_wb,"Pitchers")
addWorksheet(excel_wb,"Hitters")
addWorksheet(excel_wb,"No Data")
writeDataTable(excel_wb, 1, pitchers, startRow = 1, startCol = 1, tableStyle = "TableStyleMedium8")
writeDataTable(excel_wb, 2, hitters, startRow = 1, startCol = 1, tableStyle = "TableStyleMedium9")
writeDataTable(excel_wb, 3, no_data, startRow = 1, startCol = 1, tableStyle = "TableStyleMedium10")
saveWorkbook(excel_wb, file_name, overwrite = TRUE)
?setColWidths
setColWidths(excel_wb, sheet = 1, widths = "auto")
setColWidths(excel_wb, sheet = 2, widths = "auto")
setColWidths(excel_wb, sheet = 3, widths = "auto")
setColWidths(excel_wb, sheet = 1, cols=1:10, widths = "auto")
setColWidths(excel_wb, sheet = 2, cols=1:10, widths = "auto")
setColWidths(excel_wb, sheet = 3, cols=1:10, widths = "auto")
saveWorkbook(excel_wb, file_name, overwrite = TRUE)
library(lwnnr)
output_lwnn_basic("F:/Documents/LWNN/dmb.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(openxlsx)
library(baseballr)
library(xml2)
library(rvest)
update_current_year_stats()
output_lwnn_basic("F:/Documents/LWNN/dmb.xlsx")
library(lwnnr)
library("devtools")
document()
library(lwnnr)
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(openxlsx)
library(baseballr)
library(xml2)
library(rvest)
#update_current_year_stats()
output_lwnn_basic("F:/Documents/LWNN/dmb.xlsx")
output_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(openxlsx)
library(baseballr)
library(xml2)
library(rvest)
#update_current_year_stats()
output_lwnn_basic("F:/Documents/LWNN/dmb.xlsx")
output_lwnn_unsigned("F:/Documents/LWNN/unsigned.xlsx")
players_all <- load_salaries() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced() %>%
add_draft_2018()
View(players_all)
players_all <- load_salaries() %>%
add_dmb() %>%
add_prospects() %>%
add_zips_reduced() %>%
add_current_season_reduced() %>%
add_draft_2018() %>%
filter(is.na(lwnn))
pitchers <- players_all %>%
filter(type=="pitcher") %>%
select(name,Age,POS,T,IP,ERA,FIP,K.9,BB.9,
OPS_LHB,OPS_RHB,G.GF,STA_SP,STA_RP,
Team_2019,FIP_2019,IP_2019,
FV,ETA,Risk,draft_2018)
library(dplyr)
library(tidyr)
library(stringr)
library(lwnnr)
library(readxl)
library(openxlsx)
library(baseballr)
library(xml2)
library(rvest)
#update_current_year_stats()
output_lwnn_basic("F:/Documents/LWNN/dmb.xlsx")
output_lwnn_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(lwnnr)
library(lwnnr)
output_lwnn_basic("F:/Documents/LWNN/dmb.xlsx")
output_lwnn_unsigned("F:/Documents/LWNN/unsigned.xlsx")
library(lwnnr)
output_lwnn_unsigned("F:/Documents/LWNN/unsigned.xlsx")
